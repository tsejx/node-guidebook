(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{322:function(e,t,a){"use strict";a.r(t);var r=a(0),s=Object(r.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"æµ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æµ"}},[e._v("#")]),e._v(" æµ")]),e._v(" "),a("p",[e._v("æµï¼ˆstreamï¼‰æ˜¯ Node.js ä¸­å¤„ç†æµå¼æ•°æ®çš„æŠ½è±¡æ¥å£ã€‚æµä¹Ÿæ˜¯ä¸€ç§æ•°æ®ä¼ è¾“æ‰‹æ®µï¼Œæ˜¯æœ‰é¡ºåºçš„ï¼Œæœ‰èµ·ç‚¹å’Œç»ˆç‚¹çš„ï¼Œæ¯”å¦‚ä½ è¦æŠŠæ•°æ®ä»ä¸€ä¸ªåœ°æ–¹ä¼ åˆ°å¦ä¸€ä¸ªåœ°æ–¹ã€‚")]),e._v(" "),a("p",[e._v("ä¸ºä»€ä¹ˆæµé‚£ä¹ˆå¥½ç”¨è¿˜é‚£ä¹ˆé‡è¦å‘¢ï¼Ÿ")]),e._v(" "),a("ul",[a("li",[e._v("å› ä¸ºæœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸éœ€è¦å…³å¿ƒæ–‡ä»¶çš„ä¸»ä½“å†…å®¹ï¼Œåªéœ€å…³å¿ƒèƒ½ä¸èƒ½å–åˆ°æ•°æ®ï¼Œå–åˆ°æ•°æ®ä¹‹åæ€ä¹ˆè¿›è¡Œå¤„ç†")]),e._v(" "),a("li",[e._v("å¯¹äºå°å‹çš„æ–‡æœ¬æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ–‡ä»¶å†…å®¹å…¨éƒ¨è¯»å…¥å†…å­˜ï¼Œç„¶åå†å†™å…¥æ–‡ä»¶")]),e._v(" "),a("li",[e._v("å¯¹äºä½“ç§¯è¾ƒå¤§çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ¯”å¦‚éŸ³é¢‘ã€è§†é¢‘ç­‰å¤šåª’ä½“æ–‡ä»¶ï¼ŒåŠ¨è¾„å‡ ä¸ª GB å¤§å°ï¼Œå¦‚æœä½¿ç”¨å¸¸è§„æ–¹æ³•è¯»å–ï¼Œå¾ˆå®¹æ˜“ä½¿å†…å­˜æº¢å‡º")]),e._v(" "),a("li",[e._v("ç†æƒ³çš„æ–¹æ³•åº”è¯¥æ˜¯è¯»ä¸€éƒ¨åˆ†ï¼Œå†™ä¸€éƒ¨åˆ†ï¼Œä¸ç®¡æ–‡ä»¶æœ‰å¤šå¤§ï¼Œåªè¦æ—¶é—´å…è®¸ï¼Œæ€»ä¼šå¤„ç†å®Œæˆï¼Œè¿™é‡Œå°±éœ€è¦ç”¨åˆ°æµçš„æ¦‚å¿µ")])]),e._v(" "),a("p",[a("code",[e._v("stream")]),e._v(" æ¨¡å—æ˜¯ Node.js ä¸­ç”¨äºæ„å»ºå®ç°äº†æµæ¥å£çš„å¯¹è±¡ã€‚")]),e._v(" "),a("p",[e._v("ğŸŒ° "),a("strong",[e._v("ç¤ºä¾‹")]),e._v("ï¼šè®¿é—® "),a("code",[e._v("stream")]),e._v(" æ¨¡å—")]),e._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" stream "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'stream'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),a("p",[e._v("å°½ç®¡ç†è§£æµçš„å·¥ä½œæ–¹å¼å¾ˆé‡è¦ï¼Œä½†æ˜¯ "),a("code",[e._v("stream")]),e._v(" æ¨¡å—ä¸»è¦ç”¨äºå¼€å‘è€…åˆ›å»ºæ–°ç±»å‹çš„æµå®ä¾‹ã€‚ å¯¹äºä»¥æ¶ˆè´¹æµå¯¹è±¡ä¸ºä¸»çš„å¼€å‘è€…ï¼Œæå°‘éœ€è¦ç›´æ¥ä½¿ç”¨ "),a("code",[e._v("stream")]),e._v(" æ¨¡å—ã€‚")]),e._v(" "),a("h2",{attrs:{id:"æµçš„ç±»å‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æµçš„ç±»å‹"}},[e._v("#")]),e._v(" æµçš„ç±»å‹")]),e._v(" "),a("p",[e._v("åœ¨ Node.js ä¸­å¯¹æ–‡ä»¶çš„å¤„ç†å¤šæ•°ä½¿ç”¨æµæ¥å®Œæˆï¼š")]),e._v(" "),a("ul",[a("li",[e._v("æ™®é€šæ–‡ä»¶")]),e._v(" "),a("li",[e._v("è®¾å¤‡æ–‡ä»¶ï¼ˆstdinã€stdoutï¼‰")]),e._v(" "),a("li",[e._v("ç½‘ç»œæ–‡ä»¶ï¼ˆhttpã€netï¼‰")])]),e._v(" "),a("p",[e._v("åœ¨ Node.js ä¸­æœ‰å››ç§åŸºæœ¬çš„æµç±»å‹ï¼š")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("Writable")]),e._v("ï¼ˆå¯å†™æµï¼‰ï¼šå¯å†™æµæ˜¯æ•°æ®å¯ä»¥è¢«å†™å…¥ç›®æ ‡çš„æŠ½è±¡ï¼ˆä¾‹å¦‚ "),a("code",[e._v("fs.createWriteStream()")]),e._v("ï¼‰")]),e._v(" "),a("li",[a("code",[e._v("Readable")]),e._v("ï¼ˆå¯è¯»æµï¼‰ï¼šå¯è¯»æµæ˜¯æ•°æ®å¯ä»¥è¢«æ¶ˆè´¹çš„æŠ½è±¡ï¼ˆä¾‹å¦‚ "),a("code",[e._v("fs.createReadStream()")]),e._v("ï¼‰")]),e._v(" "),a("li",[a("code",[e._v("Duplex")]),e._v("ï¼ˆåŒå‘æµï¼‰ï¼šåŒå‘æµæ—¢æ˜¯å¯å†™çš„ä¹Ÿæ˜¯å¯è¯»çš„ï¼ˆä¾‹å¦‚ "),a("code",[e._v("net.Socket")]),e._v("ï¼‰")]),e._v(" "),a("li",[a("code",[e._v("Transform")]),e._v("ï¼ˆè½¬æ¢æµï¼‰ï¼šè½¬å‘æµåŸºäºåŒå‘æµï¼Œå¯ä»¥åœ¨è¯»æˆ–å†™çš„æ—¶å€™è¢«ç”¨æ¥æ›´æ”¹æˆ–è€…è½¬æ¢æ•°æ®ï¼ˆä¾‹å¦‚ "),a("code",[e._v("zlib.createDeflate()")]),e._v(" ä½¿ç”¨ gzip ç®—æ³•å‹ç¼©æ•°æ®ï¼‰ã€‚å¯ä»¥å°†è½¬æ¢æµæƒ³è±¡æˆä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„è¾“å…¥æ˜¯å¯å†™æµï¼Œè¾“å‡ºæ˜¯å¯è¯»æµã€‚æŸäº›åœ°æ–¹ä¹Ÿå°†è½¬æ¢æµç§°ä¸ºé€šè¿‡æµï¼ˆthrough streamsï¼‰ã€‚")])]),e._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" Stream "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'stream'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" Readable "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" Stream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Readable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" Writable "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" Stream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Writable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" Duplex "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" Stream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Duplex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" Transform "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" Stream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Transform"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),a("p",[e._v("æ‰€æœ‰æµéƒ½æ˜¯ "),a("strong",[e._v("EventEmitter")]),e._v(" çš„å®ä¾‹ã€‚è§¦å‘å®ƒä»¬çš„äº‹ä»¶å¯ä»¥è¯»æˆ–è€…å†™å…¥æ•°æ®ï¼Œç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ "),a("code",[e._v("pipe")]),e._v(" æ–¹æ³•æ¶ˆè´¹æµçš„æ•°æ®ã€‚")]),e._v(" "),a("p",[e._v("æ­¤å¤–ï¼Œè¯¥æ¨¡å—è¿˜åŒ…æ‹¬å®ç”¨å‡½æ•° "),a("code",[e._v("stream.pipeline()")]),e._v("ã€"),a("code",[e._v("stream.finished()")]),e._v(" å’Œ "),a("code",[e._v("stream.Readable.from()")]),e._v(" æ–¹æ³•ã€‚")]),e._v(" "),a("h3",{attrs:{id:"å¯¹è±¡æ¨¡å¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¯¹è±¡æ¨¡å¼"}},[e._v("#")]),e._v(" å¯¹è±¡æ¨¡å¼")]),e._v(" "),a("p",[e._v("Node.js åˆ›å»ºçš„æµéƒ½æ˜¯è¿ä½œåœ¨å­—ç¬¦ä¸²å’Œ Bufferï¼ˆæˆ– Uint8Arrayï¼‰ä¸Šã€‚ å½“ç„¶ï¼Œæµçš„å®ç°ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶å®ƒç±»å‹çš„ JavaScript å€¼ï¼ˆé™¤äº† nullï¼‰ã€‚ è¿™äº›æµä¼šä»¥ "),a("code",[e._v("å¯¹è±¡æ¨¡å¼")]),e._v(" è¿›è¡Œæ“ä½œã€‚")]),e._v(" "),a("p",[e._v("å½“åˆ›å»ºæµæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ "),a("code",[e._v("objectMode")]),e._v(" é€‰é¡¹æŠŠæµå®ä¾‹åˆ‡æ¢åˆ°"),a("strong",[e._v("å¯¹è±¡æ¨¡å¼")]),e._v("ã€‚ å°†å·²å­˜åœ¨çš„æµåˆ‡æ¢åˆ°å¯¹è±¡æ¨¡å¼æ˜¯ä¸å®‰å…¨çš„ã€‚")]),e._v(" "),a("h3",{attrs:{id:"ç¼“å†²"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç¼“å†²"}},[e._v("#")]),e._v(" ç¼“å†²")]),e._v(" "),a("p",[a("code",[e._v("å¯å†™æµ")]),e._v(" å’Œ "),a("code",[e._v("å¯è¯»æµ")]),e._v(" éƒ½ä¼šåœ¨å†…éƒ¨çš„"),a("strong",[e._v("ç¼“å†²å™¨")]),e._v("ä¸­å­˜å‚¨æ•°æ®ï¼Œå¯ä»¥åˆ†åˆ«ä½¿ç”¨çš„ "),a("code",[e._v("writable.writableBuffer")]),e._v(" æˆ– "),a("code",[e._v("readable.readableBuffer")]),e._v(" æ¥è·å–ã€‚")]),e._v(" "),a("p",[e._v("å¯ç¼“å†²çš„æ•°æ®å¤§å°å–å†³äºä¼ å…¥æµæ„é€ å‡½æ•°çš„ "),a("code",[e._v("highWaterMark")]),e._v(" é€‰é¡¹ã€‚")]),e._v(" "),a("ul",[a("li",[e._v("å¯¹äºæ™®é€šçš„æµï¼Œ "),a("code",[e._v("highWaterMark")]),e._v(" æŒ‡å®šäº†å­—èŠ‚çš„æ€»æ•°")]),e._v(" "),a("li",[e._v("å¯¹äºå¯¹è±¡æ¨¡å¼çš„æµï¼Œ "),a("code",[e._v("highWaterMark")]),e._v(" æŒ‡å®šäº†å¯¹è±¡çš„æ€»æ•°")])]),e._v(" "),a("p",[e._v("å½“è°ƒç”¨ "),a("code",[e._v("stream.push(chunk)")]),e._v(" æ—¶ï¼Œæ•°æ®ä¼šè¢«ç¼“å†²åœ¨å¯è¯»æµä¸­ã€‚ å¦‚æœæµçš„æ¶ˆè´¹è€…æ²¡æœ‰è°ƒç”¨ "),a("code",[e._v("stream.read()")]),e._v("ï¼Œåˆ™æ•°æ®ä¼šä¿ç•™åœ¨å†…éƒ¨é˜Ÿåˆ—ä¸­ç›´åˆ°è¢«æ¶ˆè´¹ã€‚")]),e._v(" "),a("p",[e._v("ä¸€æ—¦å†…éƒ¨çš„å¯è¯»ç¼“å†²çš„æ€»å¤§å°è¾¾åˆ° "),a("code",[e._v("highWaterMark")]),e._v(" æŒ‡å®šçš„é˜ˆå€¼æ—¶ï¼Œæµä¼šæš‚æ—¶åœæ­¢ä»åº•å±‚èµ„æºè¯»å–æ•°æ®ï¼Œç›´åˆ°å½“å‰ç¼“å†²çš„æ•°æ®è¢«æ¶ˆè´¹ ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæµä¼šåœæ­¢è°ƒç”¨å†…éƒ¨çš„ç”¨äºå¡«å……å¯è¯»ç¼“å†²çš„ "),a("code",[e._v("readable._read()")]),e._v("ï¼‰ã€‚")]),e._v(" "),a("p",[e._v("å½“è°ƒç”¨ "),a("code",[e._v("writable.write(chunk)")]),e._v(" æ—¶ï¼Œæ•°æ®ä¼šè¢«ç¼“å†²åœ¨å¯å†™æµä¸­ã€‚ å½“å†…éƒ¨çš„å¯å†™ç¼“å†²çš„æ€»å¤§å°å°äº "),a("code",[e._v("highWaterMark")]),e._v(" è®¾ç½®çš„é˜ˆå€¼æ—¶ï¼Œè°ƒç”¨ "),a("code",[e._v("writable.write()")]),e._v(" ä¼šè¿”å› "),a("code",[e._v("true")]),e._v("ã€‚ ä¸€æ—¦å†…éƒ¨ç¼“å†²çš„å¤§å°è¾¾åˆ°æˆ–è¶…è¿‡ "),a("code",[e._v("highWaterMark")]),e._v(" æ—¶ï¼Œåˆ™ä¼šè¿”å› "),a("code",[e._v("false")]),e._v("ã€‚")]),e._v(" "),a("p",[e._v("stream API çš„ä¸»è¦ç›®æ ‡ï¼Œç‰¹åˆ«æ˜¯ "),a("code",[e._v("stream.pipe()")]),e._v("ï¼Œæ˜¯ä¸ºäº†é™åˆ¶æ•°æ®çš„ç¼“å†²åˆ°å¯æ¥å—çš„ç¨‹åº¦ï¼Œä¹Ÿå°±æ˜¯è¯»å†™é€Ÿåº¦ä¸ä¸€è‡´çš„æºå¤´ä¸ç›®çš„åœ°ä¸ä¼šå‹å®å†…å­˜ã€‚")]),e._v(" "),a("p",[e._v("å› ä¸º Duplex å’Œ Transform éƒ½æ˜¯å¯è¯»åˆå¯å†™çš„ï¼Œæ‰€ä»¥å®ƒä»¬å„è‡ªç»´æŠ¤ç€ä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„å†…éƒ¨ç¼“å†²å™¨ç”¨äºè¯»å–å’Œå†™å…¥ï¼Œ è¿™ä½¿å¾—å®ƒä»¬åœ¨ç»´æŠ¤æ•°æ®æµæ—¶ï¼Œè¯»å–å’Œå†™å…¥ä¸¤è¾¹å¯ä»¥å„è‡ªç‹¬ç«‹åœ°è¿ä½œã€‚ ä¾‹å¦‚ï¼Œnet.Socket å®ä¾‹æ˜¯ Duplex æµï¼Œå®ƒçš„å¯è¯»ç«¯å¯ä»¥æ¶ˆè´¹ä» socket æ¥æ”¶çš„æ•°æ®ï¼Œè€Œå¯å†™ç«¯åˆ™å¯ä»¥å°†æ•°æ®å†™å…¥åˆ° socketã€‚ å› ä¸ºæ•°æ®å†™å…¥åˆ° socket çš„é€Ÿåº¦å¯èƒ½æ¯”æ¥æ”¶æ•°æ®çš„é€Ÿåº¦å¿«æˆ–è€…æ…¢ï¼Œæ‰€ä»¥è¯»å†™ä¸¤ç«¯åº”è¯¥ç‹¬ç«‹åœ°è¿›è¡Œæ“ä½œï¼ˆæˆ–ç¼“å†²ï¼‰ã€‚")]),e._v(" "),a("hr"),e._v(" "),a("p",[a("strong",[e._v("å‚è€ƒèµ„æ–™ï¼š")])]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://tech.meituan.com/2016/07/08/stream-basics.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç¾å›¢ Node.js Stream - åŸºç¡€ç¯‡"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://tech.meituan.com/2016/07/15/stream-internals.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç¾å›¢ Node.js Stream - è¿›é˜¶ç¯‡"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://tech.meituan.com/2016/07/22/stream-in-action.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("ç¾å›¢ Node.js Stream - å®æˆ˜ç¯‡"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/36728655",target:"_blank",rel:"noopener noreferrer"}},[e._v("ğŸ“ Node.js æµï¼ˆstreamï¼‰ï¼šä½ éœ€è¦çŸ¥é“çš„ä¸€åˆ‡"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://cnodejs.org/topic/56ba030271204e03637a3870",target:"_blank",rel:"noopener noreferrer"}},[e._v("é€šè¿‡æºç è§£æ Node.js ä¸­å¯¼æµï¼ˆpipeï¼‰çš„å®ç°"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://juejin.im/post/5d25ce36f265da1ba84ab97a",target:"_blank",rel:"noopener noreferrer"}},[e._v("æƒ³å­¦Node.jsï¼Œstreamå…ˆæœ‰å¿…è¦ææ¸…æ¥š"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/zoubin/streamify-your-node-program",target:"_blank",rel:"noopener noreferrer"}},[e._v("zoubin/streamify-your-node-programï¼šå¯¹ Node.js ä¸­ stream æ¨¡å—çš„å­¦ä¹ ç§¯ç´¯å’Œç†è§£"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=s.exports}}]);