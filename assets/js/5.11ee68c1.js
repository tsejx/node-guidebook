(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{216:function(t,s,a){t.exports=a.p+"assets/img/buffer-division.fd975929.jpg"},217:function(t,s,a){t.exports=a.p+"assets/img/new-slab-case.17df6417.png"},218:function(t,s,a){t.exports=a.p+"assets/img/assign-buffer-from-new-slab-case.cb15d3b0.png"},252:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"ç¼“å†²å™¨"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç¼“å†²å™¨"}},[t._v("#")]),t._v(" ç¼“å†²å™¨")]),t._v(" "),n("p",[t._v("Buffer æ˜¯ Node.js çš„æ ¸å¿ƒæ¨¡å—ï¼Œå¼€å‘è€…å¯ä»¥åˆ©ç”¨å®ƒæ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯”å¦‚æ–‡ä»¶æµçš„è¯»å†™ã€ç½‘ç»œè¯·æ±‚æ•°æ®çš„å¤„ç†ç­‰ã€‚")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.nodejs.red/#/nodejs/buffer",target:"_blank",rel:"noopener noreferrer"}},[t._v("Node.js Buffer æ–‡æ¡£"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"åŸºæœ¬æ¦‚å¿µ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åŸºæœ¬æ¦‚å¿µ"}},[t._v("#")]),t._v(" åŸºæœ¬æ¦‚å¿µ")]),t._v(" "),n("h3",{attrs:{id:"äºŒè¿›åˆ¶æ•°æ®"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#äºŒè¿›åˆ¶æ•°æ®"}},[t._v("#")]),t._v(" äºŒè¿›åˆ¶æ•°æ®")]),t._v(" "),n("p",[t._v("äºŒè¿›åˆ¶æ•°æ®ä½¿ç”¨ 0 å’Œ 1 ä¸¤ä¸ªæ•°ç æ¥è¡¨ç¤ºçš„æ•°æ®ï¼Œä¸ºäº†å­˜å‚¨æˆ–å±•ç¤ºä¸€äº›æ•°æ®ï¼Œè®¡ç®—æœºéœ€è¦å…ˆå°†è¿™äº›æ•°æ®è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ¥è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼Œæˆ‘æƒ³å­˜å‚¨ 66 è¿™ä¸ªæ•°å­—ï¼Œè®¡ç®—æœºä¼šå…ˆå°†æ•°å­— 66 è½¬åŒ–ä¸ºäºŒè¿›åˆ¶ 01000010 è¡¨ç¤ºï¼Œè½¬æ¢å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("128")]),t._v(" "),n("th",[t._v("64")]),t._v(" "),n("th",[t._v("32")]),t._v(" "),n("th",[t._v("16")]),t._v(" "),n("th",[t._v("8")]),t._v(" "),n("th",[t._v("4")]),t._v(" "),n("th",[t._v("2")]),t._v(" "),n("th",[t._v("1")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("0")]),t._v(" "),n("td",[t._v("1")]),t._v(" "),n("td",[t._v("0")]),t._v(" "),n("td",[t._v("0")]),t._v(" "),n("td",[t._v("0")]),t._v(" "),n("td",[t._v("0")]),t._v(" "),n("td",[t._v("1")]),t._v(" "),n("td",[t._v("0")])])])]),t._v(" "),n("p",[t._v("é™¤äº†æ•°å­—ç±»å‹ï¼Œè¿˜æœ‰å­—ç¬¦ä¸²ã€å›¾åƒã€æ–‡ä»¶ç­‰éœ€è¦ä½¿ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºã€‚ä¾‹å¦‚æˆ‘ä»¬å¯¹ä¸€ä¸ªè‹±æ–‡å­—æ¯ M æ“ä½œï¼Œåœ¨ JavaScript ä¸­å¯ä»¥é€šè¿‡ "),n("code",[t._v("'M'.charCodeAt()")]),t._v(" å–åˆ°å¯¹åº”çš„ ASCII ç ä¹‹åï¼ˆé€šè¿‡ä»¥ä¸Šçš„æ­¥éª¤ï¼‰ä¼šè½¬ä¸ºäºŒè¿›åˆ¶è¡¨ç¤ºã€‚")]),t._v(" "),n("h3",{attrs:{id:"stream"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#stream"}},[t._v("#")]),t._v(" Stream")]),t._v(" "),n("p",[t._v("æµï¼Œè‹±æ–‡ Stream æ˜¯å¯¹è¾“å…¥è¾“å‡ºè®¾å¤‡çš„æŠ½è±¡ï¼Œè¿™é‡Œçš„è®¾å¤‡å¯ä»¥æ˜¯æ–‡ä»¶ã€ç½‘ç»œã€å†…å­˜ç­‰ã€‚")]),t._v(" "),n("p",[t._v("æµæ˜¯æœ‰æ–¹å‘æ€§çš„ï¼Œå½“ç¨‹åºä»æŸä¸ªæ•°æ®æºè¯»å…¥æ•°æ®ï¼Œä¼šå¼€å¯ä¸€ä¸ªè¾“å…¥æµï¼Œè¿™é‡Œçš„æ•°æ®æºå¯ä»¥æ˜¯æ–‡ä»¶æˆ–è€…ç½‘ç»œç­‰ï¼Œä¾‹å¦‚æˆ‘ä»¬ä» "),n("code",[t._v("a.txt")]),t._v(" æ–‡ä»¶è¯»å…¥æ•°æ®ã€‚ç›¸åçš„å½“æˆ‘ä»¬çš„ç¨‹åºéœ€è¦å†™å‡ºæ•°æ®åˆ°æŒ‡å®šæ•°æ®æºï¼ˆæ–‡ä»¶ã€ç½‘ç»œç­‰ï¼‰æ—¶ï¼Œåˆ™å¼€å¯ä¸€ä¸ªè¾“å‡ºæµã€‚å½“æœ‰ä¸€äº›å¤§æ–‡ä»¶æ“ä½œæ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦ Stream åƒç®¡é“ä¸€æ ·ï¼Œä¸€ç‚¹ä¸€ç‚¹çš„å°†æ•°æ®æµå‡ºã€‚")]),t._v(" "),n("p",[t._v("ä¾‹å¦‚æˆ‘ä»¬éœ€è¦å°†ä¸€æ± æ°´æµ‡çŒä¸€ç‰‡èœåœ°ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å°†è¿™æ± æ°´å…¨éƒ¨å€’å…¥èœåœ°ï¼Œé¦–å…ˆéœ€è¦è¿™ä¹ˆå¤§çš„åŠ›æ°”ï¼ˆè¿™é‡Œå¥½æ¯”è®¡ç®—æœºä¸­çš„ç¡¬ä»¶æ€§èƒ½ï¼‰æ‰èƒ½æ¬å¾—åŠ¨ã€‚å¦‚æœï¼Œæˆ‘ä»¬æ‹¿æ¥äº†æ°´ç®¡å°†æ°´ä¸€ç‚¹ä¸€ç‚¹æµå…¥æˆ‘ä»¬çš„èœåœ°ï¼Œè¿™ä¸ªäº‹åä¸è¦è¿™ä¹ˆå¤§åŠ›æ°”å°±å¯ä»¥å®Œæˆã€‚")]),t._v(" "),n("h3",{attrs:{id:"buffer"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#buffer"}},[t._v("#")]),t._v(" Buffer")]),t._v(" "),n("p",[t._v("äº†è§£ Stream åï¼Œæˆ‘ä»¬çŸ¥é“æ•°æ®æ˜¯ä»ä¸€ç«¯æµå‘å¦ä¸€ç«¯ï¼Œé‚£ä¹ˆä»–ä»¬æ˜¯æ€æ ·æµåŠ¨çš„å‘¢ï¼Ÿ")]),t._v(" "),n("p",[t._v("é€šå¸¸ï¼Œæ•°æ®çš„ç§»åŠ¨æ˜¯ä¸ºäº†å¤„ç†æˆ–è€…è¯»å–å®ƒï¼Œå¹¶æ ¹æ®å®ƒè¿›è¡Œå†³ç­–ã€‚ä¼´éšç€äº‹ä»¶çš„æ¨ç§»ï¼Œæ¯ä¸€ä¸ªè¿‡ç¨‹éƒ½ä¼šæœ‰ä¸€ä¸ªæœ€å°æˆ–æœ€å¤§æ•°æ®é‡ã€‚å¦‚æœæ•°æ®åˆ°è¾¾çš„é€Ÿåº¦æ¯”è¿›ç¨‹æ¶ˆè€—å¾—é€Ÿåº¦å¿«ï¼Œé‚£ä¹ˆå°‘æ•°æ—©åˆ°è¾¾çš„æ•°æ®ä¼šå¤„äºç­‰å¾…å»ç­‰å¾…è¢«å¤„ç†ã€‚åä¹‹ï¼Œå¦‚æœæ•°æ®åˆ°è¾¾çš„é€Ÿåº¦æ¯”è¿›ç¨‹æ¶ˆè€—çš„æ•°æ®æ…¢ï¼Œé‚£ä¹ˆæ—©å…ˆåˆ°è¾¾çš„æ•°æ®éœ€è¦ç­‰å¾…ä¸€å®šé‡çš„æ•°æ®åˆ°è¾¾ä¹‹åæ‰èƒ½è¢«å¤„ç†ã€‚")]),t._v(" "),n("p",[t._v("è¿™é‡Œçš„ç­‰å¾…åŒºæŒ‡çš„å°±æ˜¯ç¼“å†²åŒºï¼ˆBufferï¼‰ï¼Œå®ƒæ˜¯è®¡ç®—æœºä¸­çš„ä¸€ä¸ªå°ç‰©ç†å•ä½ï¼Œé€šå¸¸ä½äºè®¡ç®—æœºçš„ RAM ä¸­ã€‚")]),t._v(" "),n("h2",{attrs:{id:"buffer-ç»“æ„"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#buffer-ç»“æ„"}},[t._v("#")]),t._v(" Buffer ç»“æ„")]),t._v(" "),n("p",[t._v("Buffer æ˜¯ä¸€ä¸ªç±»ä¼¼ Array çš„å¯¹è±¡ï¼Œä½†å®ƒä¸»è¦ç”¨äºæ“ä½œå­—èŠ‚ã€‚")]),t._v(" "),n("p",[t._v("ä¸‹é¢ä»"),n("strong",[t._v("æ¨¡å—ç»“æ„")]),t._v("å’Œ"),n("strong",[t._v("å¯¹è±¡ç»“æ„")]),t._v("çš„å±‚é¢æ¥è®¤è¯† Bufferã€‚")]),t._v(" "),n("h3",{attrs:{id:"æ¨¡å—ç»“æ„"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ¨¡å—ç»“æ„"}},[t._v("#")]),t._v(" æ¨¡å—ç»“æ„")]),t._v(" "),n("p",[t._v("Buffer æ˜¯å…¸å‹çš„ JavaScript ä¸ C++ ç»“åˆçš„æ¨¡å—ï¼Œå®ƒå°†æ€§èƒ½ç›¸å…³éƒ¨åˆ†ç”¨ C++ å®ç°ï¼Œå°†éæ€§èƒ½ç›¸å…³çš„éƒ¨åˆ†ç”¨ JavaScript å®ç°ã€‚")]),t._v(" "),n("p",[n("img",{attrs:{src:a(216),alt:"Buffer çš„åˆ†å·¥"}})]),t._v(" "),n("p",[t._v("Buffer æ‰€å çš„å†…å­˜ä¸æ˜¯é€šè¿‡ V8 åˆ†é…çš„ï¼Œå±äºå †å¤–å†…å­˜ã€‚ç”±äº V8 åƒåœ¾å›æ”¶æ€§èƒ½çš„å½±å“ï¼Œå°†å¸¸ç”¨çš„æ“ä½œå¯¹è±¡ç”¨æ›´é«˜æ•ˆå’Œä¸“æœ‰çš„å†…å­˜åˆ†é…å›æ”¶ç­–ç•¥æ¥ç®¡ç†æ˜¯ä¸ªä¸é”™çš„æ€è·¯ã€‚")]),t._v(" "),n("p",[t._v("ç”±äº Buffer å¤ªå¤šå¸¸è§ï¼ŒNode åœ¨è¿›ç¨‹å¯åŠ¨æ—¶å°±å·²ç»åŠ è½½äº†å®ƒï¼Œå¹¶å°†å…¶æ”¾åœ¨å…¨å±€å¯¹è±¡ï¼ˆ"),n("code",[t._v("global")]),t._v("ï¼‰ä¸Šã€‚æ‰€ä»¥åœ¨ä½¿ç”¨ Buffer æ—¶ï¼Œæ— é¡»é€šè¿‡ "),n("code",[t._v("require()")]),t._v(" å³å¯ç›´æ¥ä½¿ç”¨ã€‚")]),t._v(" "),n("h3",{attrs:{id:"å¯¹è±¡ç»“æ„"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å¯¹è±¡ç»“æ„"}},[t._v("#")]),t._v(" å¯¹è±¡ç»“æ„")]),t._v(" "),n("p",[t._v("Buffer å¯¹è±¡ç±»ä¼¼äºæ•°ç»„ï¼Œå®ƒçš„å…ƒç´ ä¸º 16 è¿›åˆ¶çš„ä¸¤ä½æ•°ï¼Œå³ 0 åˆ° 255 çš„æ•°å€¼ã€‚")]),t._v(" "),n("p",[t._v("ğŸŒ° "),n("strong",[t._v("ç¤ºä¾‹ï¼š")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" str "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ç¼“å†²å™¨'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" buf "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Buffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf-8'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("buf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// => <Buffer e7 bc 93 e5 86 b2 e5 99 a8>")]),t._v("\n")])])]),n("p",[t._v("ä»ä¸Šè¿°ä¾‹å­å¯è§ï¼Œä¸åŒç¼–ç çš„å­—ç¬¦ä¸²å ç”¨çš„å…ƒç´ ä¸ªæ•°å„ä¸ç›¸åŒï¼Œä¸Šé¢ä»£ç ä¸­çš„ä¸­æ–‡å­—åœ¨ UTF-8 ç¼–ç ä¸‹å ç”¨ 3 ä¸ªå…ƒç´ ï¼Œå­—æ¯å’ŒåŠè§’æ ‡å·å ç”¨ 1 ä¸ªå…ƒç´ ã€‚")]),t._v(" "),n("p",[t._v("Buffer å— Array ç±»å‹çš„å½±å“å¾ˆå¤§ï¼Œå¯ä»¥è®¿é—® "),n("code",[t._v("length")]),t._v(" å±æ€§å¾—åˆ°é•¿åº¦ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸‹æ ‡è®¿é—®å…ƒç´ ï¼Œåœ¨æ„é€ å¯¹è±¡æ—¶ä¹Ÿååˆ†ç›¸ä¼¼ã€‚")]),t._v(" "),n("p",[t._v("å¦‚æœå…ƒç´ èµ‹å€¼ä¸æ˜¯ 0 è‡³ 255 ä¹‹é—´çš„æ•´æ•°è€Œæ˜¯å°æ•°æ—¶ï¼Œåˆ†ä¸¤ç§æƒ…å†µï¼š")]),t._v(" "),n("ul",[n("li",[t._v("ç»™å…ƒç´ çš„èµ‹å€¼å°äº 0ï¼Œ å°±å°†è¯¥å€¼é€æ¬¡åŠ  256ï¼Œç›´åˆ°å¾—åˆ°ä¸€ä¸ª 0 åˆ° 255 ä¹‹é—´çš„æ•´æ•°")]),t._v(" "),n("li",[t._v("å¦‚æœå¾—åˆ°çš„æ•°å€¼å¤§äº 255ï¼Œå°±é€æ¬¡å‡ 256ï¼Œç›´åˆ°å¾—åˆ° 0 ï½ 255 åŒºé—´å†…çš„æ•°å€¼")]),t._v(" "),n("li",[t._v("å¦‚æœæ˜¯å°æ•°ï¼Œåªä¿ç•™æ•´æ•°éƒ¨åˆ†")])]),t._v(" "),n("h2",{attrs:{id:"buffer-å†…å­˜æœºåˆ¶"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#buffer-å†…å­˜æœºåˆ¶"}},[t._v("#")]),t._v(" Buffer å†…å­˜æœºåˆ¶")]),t._v(" "),n("p",[t._v("Buffer å¯¹è±¡çš„å†…å­˜åˆ†é…ä¸æ˜¯åœ¨ V8 çš„å †å†…å­˜ä¸­ï¼Œè€Œæ˜¯åœ¨ Node çš„ C++ å±‚é¢å®ç°å†…å­˜çš„ç”³è¯·çš„ã€‚å› ä¸ºå¤„ç†å¤§é‡çš„å­—èŠ‚æ•°æ®ä¸èƒ½é‡‡ç”¨éœ€è¦ä¸€ç‚¹å†…å­˜å°±å‘æ“ä½œç³»ç»Ÿç”³è¯·ä¸€ç‚¹å†…å­˜çš„æ–¹å¼ï¼Œè¿™å¯èƒ½é€ æˆå¤§é‡çš„å†…å­˜ç”³è¯·çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå¯¹æ“ä½œç³»ç»Ÿæœ‰ä¸€å®šå‹åŠ›ã€‚ä¸ºæ­¤ Node åœ¨å†…å­˜çš„ä½¿ç”¨ä¸Šåº”ç”¨çš„æ˜¯åœ¨ C++ å±‚é¢ç”³è¯·å†…å­˜ã€åœ¨ JavaScript ä¸­åˆ†é…å†…å­˜çš„ç­–ç•¥ã€‚å› æ­¤ï¼Œè¿™éƒ¨åˆ†å†…å­˜æˆ‘ä»¬ç§°ä¹‹ä¸º"),n("strong",[t._v("å †å¤–å†…å­˜")]),t._v("ã€‚")]),t._v(" "),n("h3",{attrs:{id:"buffer-å†…å­˜åˆ†é…åŸç†"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#buffer-å†…å­˜åˆ†é…åŸç†"}},[t._v("#")]),t._v(" Buffer å†…å­˜åˆ†é…åŸç†")]),t._v(" "),n("p",[t._v("ä¸ºäº†é«˜æ•ˆä½¿ç”¨ç”³è¯·æ¥çš„å†…å­˜ï¼ŒNode.js é‡‡ç”¨äº† slab æœºåˆ¶è¿›è¡Œé¢„å…ˆç”³è¯·ã€äº‹ååˆ†é…ï¼Œæ˜¯ä¸€ç§åŠ¨æ€çš„ç®¡ç†æœºåˆ¶ã€‚")]),t._v(" "),n("p",[t._v("ä½¿ç”¨ "),n("code",[t._v("Buffer.alloc(size)")]),t._v(" ä¼ å…¥ä¸€ä¸ªæŒ‡å®šçš„ "),n("code",[t._v("size")]),t._v(" å°±ä¼šç”³è¯·ä¸€å—å›ºå®šå¤§å°çš„å†…å­˜åŒºåŸŸï¼Œslab å…·æœ‰å¦‚ä¸‹ä¸‰ç§çŠ¶æ€ï¼š")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("full")]),t._v("ï¼šå®Œå…¨åˆ†é…çŠ¶æ€")]),t._v(" "),n("li",[n("code",[t._v("partial")]),t._v("ï¼šéƒ¨åˆ†åˆ†é…çŠ¶æ€")]),t._v(" "),n("li",[n("code",[t._v("empty")]),t._v("ï¼šæ²¡æœ‰è¢«åˆ†é…çŠ¶æ€")])]),t._v(" "),n("p",[t._v("å½“æˆ‘ä»¬éœ€è¦ä¸€ä¸ª Buffer å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ†é…æŒ‡å®šå¤§å°çš„ Buffer å¯¹è±¡ï¼š")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Buffer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("Node.js ä»¥ 8KB ä¸ºç•Œé™æ¥åŒºåˆ†æ˜¯å°å¯¹è±¡è¿˜æ˜¯å¤§å¯¹è±¡ï¼š")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("Buffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("poolSize "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 102 è¡Œï¼ŒNode.js ç‰ˆæœ¬ä¸º v10.x")]),t._v("\n")])])]),n("p",[t._v("è¿™ä¸ª 8KB çš„å€¼ä¹Ÿå°±æ˜¯æ¯ä¸ª slab çš„å¤§å°å€¼ï¼Œåœ¨ JavaScript å±‚é¢ï¼Œä»¥å®ƒä½œä¸ºå•ä½å•å…ƒè¿›è¡Œå†…å­˜çš„åˆ†é…ã€‚")]),t._v(" "),n("blockquote",[n("p",[t._v("Buffer åœ¨åˆ›å»ºæ—¶å¤§å°å·²ç»è¢«ç¡®å®šä¸”æ˜¯æ— æ³•è°ƒæ•´çš„ã€‚")])]),t._v(" "),n("h4",{attrs:{id:"åˆ†é…å°-buffer-å¯¹è±¡"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åˆ†é…å°-buffer-å¯¹è±¡"}},[t._v("#")]),t._v(" åˆ†é…å° Buffer å¯¹è±¡")]),t._v(" "),n("p",[t._v("å¦‚æœæŒ‡å®š Buffer çš„å¤§å°å°‘äº 8 KBï¼ŒNode ä¼šæŒ‰ç…§å°å¯¹è±¡çš„æ–¹å¼è¿›è¡Œåˆ†é…ã€‚Buffer çš„åˆ†é…è¿‡ç¨‹ä¸­ä¸»è¦ä½¿ç”¨ä¸€ä¸ªå±€éƒ¨å˜é‡ "),n("code",[t._v("pool")]),t._v(" ä½œä¸ºä¸­é—´å¤„ç†å¯¹è±¡ï¼Œå¤„äºåˆ†é…çŠ¶æ€çš„ "),n("code",[t._v("slab")]),t._v(" å•å…ƒéƒ½æŒ‡å‘å®ƒã€‚ä»¥ä¸‹æ˜¯åˆ†é…ä¸€ä¸ªå…¨æ–°çš„ slab å•å…ƒçš„æ“ä½œï¼Œå®ƒå°†ä¼šæ–°ç”³è¯·çš„ SlowBuffer å¯¹è±¡æŒ‡å‘å®ƒï¼š")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" pool"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("allocPool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  pool "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SlowBuffer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Buffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("poolSize"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  pool"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("used "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[n("img",{attrs:{src:a(217),alt:"æ–°æ„é€ çš„slabå•å…ƒç¤ºä¾‹"}})]),t._v(" "),n("p",[t._v("ç°åœ¨è®©æˆ‘ä»¬å°è¯•åˆ†é…ä¸€ä¸ªå¤§å°ä¸º 2048 çš„ Buffer å¯¹è±¡ï¼š")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("Buffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("alloc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("æˆ‘ä»¬çœ‹çœ‹å½“å‰çš„ slab å•å…ƒå†…å­˜æ˜¯æ€æ ·çš„ï¼š")]),t._v(" "),n("p",[n("img",{attrs:{src:a(218),alt:"ä»ä¸€ä¸ªæ–°çš„slabå•å…ƒä¸­åˆæ¬¡åˆ†é…ä¸€ä¸ªBufferå¯¹è±¡"}})]),t._v(" "),n("p",[t._v("é‚£ä¹ˆè¿™ä¸ªåˆ†é…è¿‡ç¨‹æ˜¯æ€æ ·çš„å‘¢ï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹ buffer.js å¦å¤–ä¸€ä¸ªæ ¸å¿ƒçš„æ–¹æ³• "),n("code",[t._v("allocate(size)")]),t._v("ã€‚")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// https://github.com/nodejs/node/blob/v10.x/lib/buffer.js#L318")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("allocate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("size "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FastBuffer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“åˆ†é…çš„ç©ºé—´å°äº Buffer.poolSize å‘å³ç§»ä½ï¼Œè¿™é‡Œå¾—å‡ºæ¥çš„ç»“æœä¸º 4KB")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("size "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" Buffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("poolSize "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("size "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" poolSize "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" poolOffset"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createPool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" b "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FastBuffer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("allocPool"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" poolOffset"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    poolOffset "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å·²ä½¿ç”¨ç©ºé—´ç´¯åŠ ")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("alignPool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 8 å­—èŠ‚å†…å­˜å¯¹é½å¤„ç†")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// C++ å±‚é¢ç”³è¯·")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createUnsafeBuffer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("è¿™æ—¶å€™çš„ slab çŠ¶æ€ä¸º partialï¼ˆéƒ¨åˆ†åˆ†é…çŠ¶æ€ï¼‰ã€‚")]),t._v(" "),n("p",[t._v("å½“å†æ¬¡åˆ›å»º Buffer å¯¹è±¡æ—¶ï¼Œæ„é€ è¿‡ç¨‹ä¸­å°†ä¼šåˆ¤æ–­è¿™ä¸ª slab çš„å‰©ä½™ç©ºé—´æ˜¯å¦è¶³å¤Ÿã€‚å¦‚æœè¶³å¤Ÿï¼Œä½¿ç”¨å‰©ä½™ç©ºé—´ï¼Œå¹¶æ›´æ–° slab çš„åˆ†é…çŠ¶æ€ã€‚")]),t._v(" "),n("p",[t._v("å¦‚æœ slab çš„å‰©ä½™ç©ºé—´ä¸å¤Ÿï¼Œå°†ä¼šæ„é€ æ–°çš„ slabï¼ŒåŸ slab ä¸­å‰©ä½™çš„ç©ºé—´ä¼šé€ æˆæµªè´¹ã€‚ä¾‹å¦‚ï¼Œç¬¬ä¸€æ¬¡æ„é€  1 å­—èŠ‚çš„ Buffer å¯¹è±¡ï¼Œç¬¬äºŒæ¬¡æ„é€  8192 å­—èŠ‚çš„ Buffer å¯¹è±¡ï¼Œç”±äºç¬¬äºŒæ¬¡åˆ†é…æ—¶ slab ä¸­çš„ç©ºé—´ä¸å¤Ÿï¼Œæ‰€ä»¥ä¼šåˆ›å»ºå¹¶ä½¿ç”¨æ–°çš„ slabï¼Œç¬¬ä¸€ä¸ª slab çš„ 8KB å°†ä¼šè¢«ç¬¬ä¸€ä¸ª 1 å­—èŠ‚çš„ Buffer å¯¹è±¡ç‹¬å ã€‚")]),t._v(" "),n("p",[t._v("è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œå› ä¸ºåŒä¸€ä¸ª slab å¯èƒ½åˆ†é…ç»™å¤šä¸ª Buffer å¯¹è±¡ä½¿ç”¨ï¼Œåªæœ‰è¿™äº›å° Buffer å¯¹è±¡åœ¨ä½œç”¨åŸŸé‡Šæ”¾å¹¶éƒ½å¯ä»¥å›æ”¶æ—¶ï¼Œslab çš„ 8KB ç©ºé—´æ‰ä¼šè¢«å›æ”¶ã€‚å°½ç®¡åˆ›å»ºäº† 1 ä¸ªå­—èŠ‚çš„ Buffer å¯¹è±¡ï¼Œä½†æ˜¯å¦‚æœä¸æ˜¯æ”¾å®ƒï¼Œå®é™…å¯èƒ½æ˜¯ 8KB çš„å†…å­˜æ²¡æœ‰é‡Šæ”¾ã€‚")]),t._v(" "),n("h4",{attrs:{id:"åˆ†é…å¤§-buffer-å¯¹è±¡"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åˆ†é…å¤§-buffer-å¯¹è±¡"}},[t._v("#")]),t._v(" åˆ†é…å¤§ Buffer å¯¹è±¡")]),t._v(" "),n("p",[t._v("å¦‚æœéœ€è¦è¶…è¿‡ 8KB çš„ Buffer å¯¹è±¡ï¼Œå°†ä¼šç›´æ¥åˆ†é…ä¸€ä¸ª SlowBuffer å¯¹è±¡ä½œä¸º slab å•å…ƒï¼Œè¿™ä¸ª slab å•å…ƒå°†ä¼šè¢«è¿™ä¸ªå¤§ Buffer å¯¹è±¡ç‹¬å ã€‚")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Big Bufferï¼Œjust alloc one")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parent "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SlowBuffer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offset "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("è¿™é‡Œçš„ SlowBuffer ç±»æ˜¯åœ¨ C++ ä¸­å®šä¹‰çš„ï¼Œè™½ç„¶å¼•ç”¨ buffer æ¨¡å—å¯ä»¥è®¿é—®åˆ°å®ƒï¼Œä½†æ˜¯ä¸æ¨èç›´æ¥æ“ä½œå®ƒï¼Œè€Œæ˜¯ç”¨ Buffer æ›¿ä»£ã€‚")]),t._v(" "),n("p",[t._v("ä¸Šé¢æåˆ°çš„ Buffer å¯¹è±¡éƒ½æ˜¯ JavaScript å±‚é¢çš„ï¼Œèƒ½å¤Ÿè¢« V8 çš„åƒåœ¾å›æ”¶æ ‡è®°å›æ”¶ã€‚ä½†æ˜¯å…¶å†…éƒ¨çš„ "),n("code",[t._v("parent")]),t._v(" å±æ€§æŒ‡å‘çš„ SlowBuffer å¯¹è±¡å´æ¥è‡ªäº Node è‡ªèº« C++ å®šä¹‰ï¼Œæ˜¯ C++ å±‚é¢ä¸Šçš„ Buffer å¯¹è±¡ï¼Œæ‰€ç”¨å†…å­˜ä¸åœ¨ V8 çš„å †ä¸­ã€‚")]),t._v(" "),n("h4",{attrs:{id:"å†…å­˜åˆ†é…æ€»ç»“"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜åˆ†é…æ€»ç»“"}},[t._v("#")]),t._v(" å†…å­˜åˆ†é…æ€»ç»“")]),t._v(" "),n("ol",[n("li",[t._v("åœ¨åˆæ¬¡åŠ è½½æ—¶å°±ä¼šåˆå§‹åŒ– 1 ä¸ª 8KB çš„å†…å­˜ç©ºé—´ï¼Œ"),n("code",[t._v("buffer.js")]),t._v(" æºç æœ‰æç°")]),t._v(" "),n("li",[t._v("æ ¹æ®ç”³è¯·çš„å†…å­˜å¤§å°åˆ†ä¸º "),n("strong",[t._v("å° Buffer å¯¹è±¡")]),t._v(" å’Œ "),n("strong",[t._v("å¤§ Buffer å¯¹è±¡")])]),t._v(" "),n("li",[t._v("å° Buffer æƒ…å†µï¼Œä¼šç»§ç»­åˆ¤æ–­è¿™ä¸ª slab ç©ºé—´æ˜¯å¦è¶³å¤Ÿ")])]),t._v(" "),n("ul",[n("li",[t._v("å¦‚æœç©ºé—´è¶³å¤Ÿå°±å»ä½¿ç”¨å‰©ä½™ç©ºé—´åŒæ—¶æ›´æ–° slab åˆ†é…å£®ä½“å•Šï¼Œåç§»é‡ä¼šå¢åŠ ")]),t._v(" "),n("li",[t._v("å¦‚æœç©ºé—´ä¸è¶³ï¼Œslab ç©ºé—´ä¸è¶³ï¼Œå°±ä¼šå»åˆ›å»ºä¸€ä¸ªæ–°çš„ slab ç©ºé—´ç”¨æ¥åˆ†é…")])]),t._v(" "),n("ol",{attrs:{start:"4"}},[n("li",[t._v("å¤§ Buffer æƒ…å†µï¼Œåˆ™ä¼šç›´æ¥èµ° "),n("code",[t._v("creatUnsafeBuffer(size)")]),t._v(" å‡½æ•°")]),t._v(" "),n("li",[t._v("ä¸è®ºæ˜¯å° Buffer å¯¹è±¡è¿˜æ˜¯å¤§ Buffer å¯¹è±¡ï¼Œå†…å­˜åˆ†é…æ˜¯åœ¨ C++ å±‚é¢å®Œæˆï¼Œå†…å­˜ç®¡ç†åœ¨ JavaScript å±‚é¢ï¼Œæœ€ç»ˆè¿˜æ˜¯å¯ä»¥è¢« V8 çš„åƒåœ¾å›æ”¶æ ‡è®°æ‰€å›æ”¶")])]),t._v(" "),n("h2",{attrs:{id:"ä½¿ç”¨æ–¹æ³•"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨æ–¹æ³•"}},[t._v("#")]),t._v(" ä½¿ç”¨æ–¹æ³•")]),t._v(" "),n("h3",{attrs:{id:"å®ä¾‹åŒ–æ–¹å¼"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å®ä¾‹åŒ–æ–¹å¼"}},[t._v("#")]),t._v(" å®ä¾‹åŒ–æ–¹å¼")]),t._v(" "),n("p",[t._v("åœ¨ Node.js v6 ä¹‹å‰éƒ½æ˜¯é€šè¿‡è°ƒç”¨æ„é€ å‡½æ•°çš„æ–¹å¼å®ä¾‹åŒ– Bufferï¼Œæ ¹æ®å‚æ•°è¿”å›ä¸åŒç»“æœã€‚å¤„äºå®‰å…¨æ€§åŸå› ï¼Œè¿™ç§æ–¹å¼åœ¨ v6 åçš„ç‰ˆæœ¬ä¸­å·²ç»è¢«åºŸé™¤ï¼Œæä¾›äº†ï¼š")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("Buffer.from()")])]),t._v(" "),n("li",[n("code",[t._v("Buffer.alloc()")])]),t._v(" "),n("li",[n("code",[t._v("Buffer.allocUnsafe()")])])]),t._v(" "),n("p",[t._v("ä¸‰ä¸ªå•ç‹¬çš„ï¼ŒèŒè´£æ¸…æ™°çš„å‡½æ•°å¤„ç†å®ä¾‹åŒ– Buffer çš„å·¥ä½œã€‚")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("Buffer.from(array)")]),t._v("ï¼šè¿”å›ä¸€ä¸ªå†…å®¹åŒ…å«æ‰€æä¾›çš„å­—èŠ‚å‰¯æœ¬çš„ Bufferï¼Œæ•°ç»„ä¸­æ¯é¡¹æ˜¯ä¸€ä¸ªè¡¨ç¤ºå…«ä½å­—èŠ‚çš„æ•°å­—ï¼Œæ‰€ä»¥å€¼å¿…é¡»åœ¨ 0~255 ä¹‹é—´ï¼Œå¦åˆ™ä¼šå–æ¨¡")]),t._v(" "),n("li",[n("code",[t._v("Buffer.from(arrayBuffer)")]),t._v("ï¼šè¿”å›ä¸€ä¸ªä¸ç»™å®šçš„ ArrayBuffer å…±äº«å†…å­˜çš„æ–° Buffer")]),t._v(" "),n("li",[n("code",[t._v("Buffer.from(buffer)")]),t._v("ï¼šè¿”å›ç»™å®š Buffer çš„ä¸€ä¸ªå‰¯æœ¬ Buffer")]),t._v(" "),n("li",[n("code",[t._v("Buffer.from(string [, encoding])")]),t._v("ï¼šè¿”å›ä¸€ä¸ªåŒ…å«ç»™å®šå­—ç¬¦ä¸²çš„ Buffer")]),t._v(" "),n("li",[n("code",[t._v("Buffer.alloc(size [, fill [, encoding]])")]),t._v("ï¼šè¿”å›æŒ‡å®šå¤§å°å¹¶ä¸”å·²å¡«å……çš„ Buffer")]),t._v(" "),n("li",[n("code",[t._v("Buffer.allocUnsafa(size)")]),t._v("ï¼šè¿”å›æŒ‡å®šå¤§å°çš„ Bufferï¼Œå†…å®¹å¿…é¡»ç”¨ "),n("code",[t._v("buf.fill(0)")]),t._v(" ç­‰æ–¹æ³•å¡«å……")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 0x è¡¨ç¤º 16è¿›åˆ¶")]),t._v("\n\nBuffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// [0x1, 0x2, 0x3]")]),t._v("\n\nBuffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf-8'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// [0x74, 0x65, 0x73, 0x74]")]),t._v("\n\nBuffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("alloc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// [0x1, 0x1, 0x1, 0x1, 0x1]")]),t._v("\n\nBuffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("allocUnsafe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å€¼ä¸ç¡®å®šï¼Œåé¢è¯¦è°ˆ")]),t._v("\n")])])]),n("p",[n("code",[t._v("Buffer.allocUnsafe()")]),t._v(" çš„æ‰§è¡Œä¼šå¿«äº "),n("code",[t._v("Buffer.alloc()")]),t._v("ï¼Œçœ‹åå­—å¾ˆä¸å®‰å…¨ï¼Œç¡®å®ä¹Ÿä¸å®‰å…¨ã€‚")]),t._v(" "),n("p",[t._v("å½“è°ƒç”¨ "),n("code",[t._v("Buffer.allocUnsafe()")]),t._v(" æ—¶åˆ†é…çš„å†…å­˜æ®µå°šæœªåˆå§‹åŒ–ï¼ˆä¸å½’é›¶ï¼‰ï¼Œè¿™æ ·åˆ†é…å†…å­˜é€Ÿåº¦å¾ˆå—ï¼Œä½†åˆ†é…åˆ°çš„å†…å­˜ç‰‡æ®µå¯èƒ½åŒ…å«æ—§æ•°æ®ã€‚å¦‚æœåœ¨ä½¿ç”¨çš„æ—¶å€™ä¸è¦†ç›–è¿™äº›æ—§æ•°æ®å°±å¯èƒ½é€ æˆå†…å­˜æ³„éœ²ï¼Œè™½ç„¶é€Ÿåº¦å¿«ï¼Œå°½é‡é¿å…ä½¿ç”¨ã€‚")]),t._v(" "),n("h3",{attrs:{id:"å­—ç¬¦ç¼–ç "}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å­—ç¬¦ç¼–ç "}},[t._v("#")]),t._v(" å­—ç¬¦ç¼–ç ")]),t._v(" "),n("p",[t._v("é€šè¿‡ä½¿ç”¨å­—ç¬¦ç¼–ç ï¼Œå¯å®ç° Buffer å®ä¾‹ä¸ JavaScript å­—ç¬¦ä¸²ä¹‹é—´çš„ç›¸äº’è½¬æ¢ï¼Œç›®å‰æ‰€æ”¯æŒçš„å­—ç¬¦ç¼–ç å¦‚ä¸‹æ‰€ç¤ºï¼š")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("ascii")]),t._v("ï¼šä»…é€‚ç”¨äº 7 ä½ ASCII æ•°æ®ã€‚æ­¤ç¼–ç é€Ÿåº¦å¾ˆå¿«ï¼Œå¦‚æœè®¾ç½®åˆ™ä¼šå‰¥ç¦»é«˜ä½ã€‚")]),t._v(" "),n("li",[n("code",[t._v("utf8")]),t._v("ï¼šå¤šå­—èŠ‚ç¼–ç çš„ Unicode å­—ç¬¦ã€‚è®¸å¤šç½‘é¡µå’Œå…¶ä»–æ–‡æ¡£æ ¼å¼éƒ½é€‚ç”¨ UTF-8.")]),t._v(" "),n("li",[n("code",[t._v("utf16le")]),t._v("ï¼š2 æˆ– 4 ä¸ªå­—èŠ‚ï¼Œå°ç«¯åºç¼–ç çš„ Unicode å­—ç¬¦ã€‚æ”¯æŒä»£ç†å¯¹ï¼ˆU+10000 è‡³ U+10FFFFï¼‰ã€‚")]),t._v(" "),n("li",[n("code",[t._v("ucs2")]),t._v("ï¼š"),n("code",[t._v("utf16le")]),t._v(" çš„åˆ«å")]),t._v(" "),n("li",[n("code",[t._v("base64")]),t._v("ï¼šBase64 ç¼–ç ã€‚å½“ä»å­—ç¬¦ä¸²åˆ›å»º Buffer æ—¶ï¼Œæ­¤ç¼–ç ä¹Ÿä¼šæ­£ç¡®åœ°æ¥å— RFC 4648 ç¬¬ 5 èŠ‚ä¸­æŒ‡å®šçš„ URL å’Œæ–‡ä»¶åå®‰å…¨å­—æ¯ã€‚")]),t._v(" "),n("li",[n("code",[t._v("latin1")]),t._v("ï¼šä¸€ç§å°† Buffer ç¼–ç æˆå•å­—èŠ‚ç¼–ç å­—ç¬¦ä¸²çš„æ–¹æ³•ï¼ˆç”± RFC 1345 ä¸­çš„ IANA å®šä¹‰ï¼Œç¬¬ 63 é¡µï¼Œä½œä¸º Latin-1 çš„è¡¥å……å—å’Œ CO/C1 æ§åˆ¶ç ï¼‰")]),t._v(" "),n("li",[n("code",[t._v("binary")]),t._v("ï¼š"),n("code",[t._v("latin1")]),t._v(" çš„åˆ«å")]),t._v(" "),n("li",[n("code",[t._v("hex")]),t._v("ï¼šå°†æ¯ä¸ªå­—èŠ‚ç¼–ç æˆä¸¤ä¸ªåå…­è¿›åˆ¶çš„å­—ç¬¦")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" buf "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Buffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello world!'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ascii'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("buf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hex'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 68656c6c6f20776f726c64")]),t._v("\n")])])]),n("h3",{attrs:{id:"ç±»å‹è½¬æ¢"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç±»å‹è½¬æ¢"}},[t._v("#")]),t._v(" ç±»å‹è½¬æ¢")]),t._v(" "),n("p",[t._v("å…³äº Buffer çš„ç±»å‹è½¬æ¢æœ‰ä¸¤ç§ï¼š")]),t._v(" "),n("ul",[n("li",[t._v("å­—ç¬¦ä¸²è½¬ Buffer")]),t._v(" "),n("li",[t._v("Buffer è½¬å­—ç¬¦ä¸²")])]),t._v(" "),n("h4",{attrs:{id:"å­—ç¬¦ä¸²è½¬-buffer"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å­—ç¬¦ä¸²è½¬-buffer"}},[t._v("#")]),t._v(" å­—ç¬¦ä¸²è½¬ Buffer")]),t._v(" "),n("p",[t._v("è¿™ä¸ªç›¸ä¿¡ä¸ä¼šé™Œç”Ÿï¼Œé€šè¿‡ä¸Šé¢è®²è§£çš„ "),n("code",[t._v("Buffer.from()")]),t._v(" å®ç°ï¼Œå¦‚æœä¸ä¼ é€’ "),n("code",[t._v("encoding")]),t._v(" é»˜è®¤æŒ‰ç…§ UTF-8 æ ¼å¼è½¬æ¢å­˜å‚¨ã€‚")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" buf "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Buffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello world!'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'UTF-8'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("buf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// <Buffer 48 65 6c 6c 6f 20 77 6f 72 6c 64 21>")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("buf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 12")]),t._v("\n")])])]),n("h4",{attrs:{id:"buffer-è½¬å­—ç¬¦ä¸²"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#buffer-è½¬å­—ç¬¦ä¸²"}},[t._v("#")]),t._v(" Buffer è½¬å­—ç¬¦ä¸²")]),t._v(" "),n("p",[t._v("Buffer è½¬å­—ç¬¦ä¸²ä¹Ÿå¾ˆç®€å•ï¼Œä½¿ç”¨ "),n("code",[t._v("toString([encoding], [start], [end])")]),t._v(" æ–¹æ³•ï¼Œé»˜è®¤ç¼–ç ä»ä¸º UTF-8ï¼Œå¦‚æœä¸ä¼  "),n("code",[t._v("start")]),t._v("ã€"),n("code",[t._v("end")]),t._v(" å¯å®ç°å…¨éƒ¨è½¬æ¢ï¼Œä¼ äº† "),n("code",[t._v("start")]),t._v("ã€"),n("code",[t._v("end")]),t._v(" å¯å®ç°éƒ¨åˆ†è½¬æ¢ã€‚")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" buf "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Buffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello world!'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'UTF-8'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("buf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// <Buffer 48 65 6c 6c 6f 20 77 6f 72 6c 64 21>")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("buf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 12")]),t._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("buf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'UTF-8'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Hello wor")]),t._v("\n")])])]),n("h4",{attrs:{id:"stringdecoder"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#stringdecoder"}},[t._v("#")]),t._v(" StringDecoder")]),t._v(" "),n("p",[t._v("åœ¨ Node ä¸­ä¸€ä¸ªæ±‰å­—ç”±ä¸‰ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œå¦‚æœæˆ‘ä»¬å¤„ç†ä¸­æ–‡å­—ç¬¦çš„æ—¶å€™ä½¿ç”¨äº†ä¸æ˜¯ 3 çš„èƒŒä¹¦çš„å­—èŠ‚æ•°å°±ä¼šé€ æˆå­—ç¬¦æ‹¼æ¥ä¹±ç çš„é—®é¢˜ã€‚")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" buf "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Buffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ä¸­æ–‡å­—ç¬¦ä¸²ï¼'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" buf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" b "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Buffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("allocUnsafe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  buf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("copy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("é€šè¿‡ "),n("code",[t._v("string_decoder")]),t._v(" æ¨¡å—å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" StringDecoder "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'string_decoder'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StringDecoder"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" decoder "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StringDecoder")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf-8'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" buf "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Buffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ä¸­æ–‡å­—ç¬¦ä¸²ï¼'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" buf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" b "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Buffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("allocUnsafe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  buf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("copy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("decoder"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("StringDecoder åœ¨å¾—åˆ°ç¼–ç åï¼Œç›´åˆ°å®½å­—èŠ‚åœ¨ UTF-8 ä¸‹å  3 ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥åœ¨å¤„ç†æœ«å°¾ä¸å…¨çš„å­—èŠ‚æ—¶ï¼Œä¼šä¿ç•™åˆ°ç¬¬äºŒæ¬¡ "),n("code",[t._v("write()")]),t._v("ã€‚ç›®å‰åªèƒ½å¤„ç† UTF-8ã€Base64 å’Œ UCS-2/UTF-16LEã€‚")]),t._v(" "),n("h2",{attrs:{id:"buffer-åº”ç”¨åœºæ™¯"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#buffer-åº”ç”¨åœºæ™¯"}},[t._v("#")]),t._v(" Buffer åº”ç”¨åœºæ™¯")]),t._v(" "),n("p",[t._v("ç”±äºåº”ç”¨åœºæ™¯ä¸åŒï¼Œåœ¨ Node ä¸­ï¼Œåº”ç”¨éœ€è¦å¤„ç†ç½‘ç»œåè®®ã€æ“ä½œæ•°æ®åº“ã€å¤„ç†å›¾ç‰‡ã€æ¥æ”¶ä¸Šä¼ æ–‡ä»¶ç­‰ï¼Œåœ¨ç½‘ç»œæµå’Œæ–‡ä»¶çš„æ“ä½œä¸­ï¼Œè¿˜è¦å¤„ç†å¤§é‡äºŒè¿›åˆ¶æ•°æ®ï¼ŒJavaScript è‡ªæœ‰çš„å­—ç¬¦ä¸²è¿œè¿œä¸èƒ½æ»¡è¶³è¿™äº›éœ€æ±‚ï¼Œäºæ˜¯ Buffer å¯¹è±¡åº”è¿è€Œç”Ÿã€‚")]),t._v(" "),n("h2",{attrs:{id:"i-o-æ“ä½œ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#i-o-æ“ä½œ"}},[t._v("#")]),t._v(" I/O æ“ä½œ")]),t._v(" "),n("p",[t._v("å…³äº I/O å¯ä»¥æ˜¯æ–‡ä»¶æˆ–ç½‘ç»œ I/Oï¼Œä»¥ä¸‹ä¸ºé€šè¿‡æµçš„æ–¹å¼å°† input.txt çš„ä¿¡æ¯è¯»å–å‡ºæ¥ä¹‹åå†™å…¥åˆ° output.txt æ–‡ä»¶ã€‚")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" inputStream "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("creatReadStream")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'input.txt'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºå¯è¯»æµ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" outputStream "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("creatWriteStream")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'output.txt'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºå¯å†™æµ")]),t._v("\n\ninputStream"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("outputStream"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç®¡é“è¯»å†™")]),t._v("\n")])])]),n("p",[t._v("åœ¨ Stream ä¸­æˆ‘ä»¬æ˜¯ä¸éœ€è¦æ‰‹åŠ¨å»åˆ›å»ºè‡ªå·±çš„ç¼“å†²åŒºï¼Œåœ¨ Node.js çš„æµä¸­å°†ä¼šè‡ªåŠ¨åˆ›å»ºã€‚")]),t._v(" "),n("h2",{attrs:{id:"åŠ è§£å¯†"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åŠ è§£å¯†"}},[t._v("#")]),t._v(" åŠ è§£å¯†")]),t._v(" "),n("p",[t._v("åœ¨ä¸€äº›åŠ è§£å¯†ç®—æ³•ä¸­ä¼šé‡åˆ°ä½¿ç”¨ Bufferï¼Œä¾‹å¦‚ "),n("code",[t._v("crypto.createCipheriv")]),t._v(" çš„ç¬¬äºŒä¸ªå‚æ•° "),n("code",[t._v("key")]),t._v(" ä¸º String æˆ– Buffer ç±»å‹ï¼Œå¦‚æœæ˜¯ Buffer ç±»å‹ï¼Œå°±ç”¨åˆ°äº†æœ¬ç¯‡æˆ‘ä»¬è®²è§£çš„å†…å®¹ï¼Œä»¥ä¸‹åšäº†ä¸€ä¸ªç®€å•çš„åŠ å¯†ç¤ºä¾‹ï¼Œé‡ç‚¹ä½¿ç”¨äº† "),n("code",[t._v("Buffer.alloc()")]),t._v(" åˆå§‹åŒ–ä¸€ä¸ªå®ä¾‹ï¼ˆè¿™ä¸ªä¸Šé¢æœ‰ä»‹ç»ï¼‰ï¼Œä¹‹åä½¿ç”¨äº† "),n("code",[t._v("fill")]),t._v(" æ–¹æ³•åšäº†å¡«å……ï¼Œè¿™é‡Œé‡ç‚¹åœ¨çœ‹ä¸‹è¿™ä¸ªæ–¹æ³•çš„ä½¿ç”¨ã€‚")]),t._v(" "),n("p",[n("code",[t._v("buf.fill(value [, offset [, end]][, encoding])")])]),t._v(" "),n("ul",[n("li",[n("code",[t._v("value")]),t._v("ï¼šç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¦å¡«å……çš„å†…å®¹")]),t._v(" "),n("li",[n("code",[t._v("offset")]),t._v("ï¼šåç§»é‡ï¼Œå¡«å……çš„èµ·å§‹ä½ç½®")]),t._v(" "),n("li",[n("code",[t._v("end")]),t._v("ï¼šç»“æŸå¡«å…… buf çš„åç§»é‡")]),t._v(" "),n("li",[n("code",[t._v("encoding")]),t._v("ï¼šç¼–ç é›†")])]),t._v(" "),n("p",[t._v("ä»¥ä¸‹ä¸º Cipher çš„å †æˆåŠ å¯† Demoï¼š")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" crypto "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'crypto'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" iv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" algorithm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cipherEncoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a123456789'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'aes-128-ecb'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'base64'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("handleKey")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bytes "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Buffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("alloc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆå§‹åŒ–ä¸€ä¸ª Buffer å®ä¾‹ï¼Œæ¯ä¸€é¡¹éƒ½ç”¨ 00 å¡«å……")]),t._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bytes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// <Buffer 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00>")]),t._v("\n\n  bytes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("fill")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¡«å……")]),t._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bytes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// <Buffer 61 31 32 33 34 35 36 37 38 39 00 00 00 00 00 00>")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" bytes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" cipher "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" crypto"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createCipheriv")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("algorithm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleKey")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" iv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" crypted "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cipher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Node.js æŠ€æœ¯æ ˆ'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cipherEncoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ncrypted "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" cipher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("final")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cipherEncoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("crypted"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// jE0ODwuKN6iaKFKqd3RF4xFZkOpasy8WfIDl8tRC5t0=")]),t._v("\n")])])]),n("h2",{attrs:{id:"buffer-vs-cache"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#buffer-vs-cache"}},[t._v("#")]),t._v(" Buffer VS Cache")]),t._v(" "),n("p",[t._v("ç¼“å†²ï¼ˆBufferï¼‰ä¸ç¼“å­˜ï¼ˆCacheï¼‰çš„åŒºåˆ«ï¼Ÿ")]),t._v(" "),n("h3",{attrs:{id:"ç¼“å†²ï¼ˆbufferï¼‰"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç¼“å†²ï¼ˆbufferï¼‰"}},[t._v("#")]),t._v(" ç¼“å†²ï¼ˆBufferï¼‰")]),t._v(" "),n("p",[t._v("ç¼“å†²ï¼ˆBufferï¼‰æ˜¯ç”¨äºå¤„ç†äºŒè¿›åˆ¶æµæ•°æ®ï¼Œå°†æ•°æ®ç¼“å†²èµ·æ¥ï¼Œå®ƒæ˜¯ä¸´æ—¶æ€§çš„ï¼Œå¯¹äºæµå¼æ•°æ®ï¼Œä¼šé‡‡ç”¨ç¼“å†²åŒºå°†æ•°æ®ä¸´æ—¶å­˜å‚¨èµ·æ¥ï¼Œç­‰ç¼“å†²åˆ°ä¸€å®šçš„å¤§å°ä¹‹ååœ¨å­˜å…¥ç¡¬ç›˜ä¸­ã€‚è§†é¢‘æ’­æ”¾å™¨å°±æ˜¯ä¸€ä¸ªç»å…¸çš„ä¾‹å­ï¼Œæœ‰æ—¶ä½ ä¼šçœ‹åˆ°ä¸€ä¸ªç¼“å†²çš„å›¾æ ‡ï¼Œè¿™æ„å‘³ç€æ­¤æ—¶è¿™ä¸€ç»„ç¼“å†²åŒºå¹¶æœªå¡«æ»¡ï¼Œå½“æ•°æ®åˆ°è¾¾å¡«æ»¡ç¼“å†²åŒºå¹¶ä¸”è¢«å¤„ç†ä¹‹åï¼Œæ­¤æ—¶ç¼“å†²å›¾æ ‡æ¶ˆå¤±ï¼Œä½ å¯ä»¥çœ‹åˆ°ä¸€äº›å›¾åƒæ•°æ®ã€‚")]),t._v(" "),n("h3",{attrs:{id:"ç¼“å­˜ï¼ˆcacheï¼‰"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç¼“å­˜ï¼ˆcacheï¼‰"}},[t._v("#")]),t._v(" ç¼“å­˜ï¼ˆCacheï¼‰")]),t._v(" "),n("p",[t._v("ç¼“å­˜ï¼ˆCacheï¼‰æˆ‘ä»¬å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªä¸­é—´å±‚ï¼Œå®ƒå¯ä»¥æ˜¯æ°¸ä¹…æ€§çš„å°†çƒ­ç‚¹æ•°æ®è¿›è¡Œç¼“å­˜ï¼Œä½¿å¾—è®¿é—®é€Ÿåº¦æ›´å¿«ï¼Œä¾‹å¦‚æˆ‘ä»¬é€šè¿‡ Memoryã€Redis ç­‰å°†æ•°æ®ä»ç¡¬ç›˜æˆ–å…¶å®ƒç¬¬ä¸‰æ–¹æ¥å£ä¸­è¯·æ±‚è¿‡æ¥è¿›è¡Œç¼“å­˜ï¼Œç›®çš„å°±æ˜¯å°†æ•°æ®å­˜äºå†…å­˜çš„ç¼“å­˜åŒºä¸­ï¼Œè¿™æ ·å¯¹åŒä¸€ä¸ªèµ„æºè¿›è¡Œè®¿é—®ï¼Œé€Ÿåº¦ä¼šæ›´å¿«ï¼Œä¹Ÿæ˜¯æ€§èƒ½ä¼˜åŒ–ä¸€ä¸ªé‡è¦çš„ç‚¹ã€‚")]),t._v(" "),n("p",[t._v("æ¥è‡ªçŸ¥ä¹çš„ä¸€ä¸ªè®¨è®ºï¼Œè¯¦æƒ…æŸ¥é˜… "),n("a",{attrs:{href:"https://www.zhihu.com/question/26190832",target:"_blank",rel:"noopener noreferrer"}},[t._v("Cache å’Œ Buffer éƒ½æ˜¯ç¼“å­˜ï¼Œä¸»è¦åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"buffer-vs-string"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#buffer-vs-string"}},[t._v("#")]),t._v(" Buffer VS String")]),t._v(" "),n("p",[t._v("é€šè¿‡å‹åŠ›æµ‹è¯•æ¥çœ‹çœ‹ String å’Œ Buffer ä¸¤è€…çš„æ€§èƒ½å¦‚ä½•ï¼Ÿ")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" s "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  s "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" str "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bufStr "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Buffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/buffer'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bufStr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/string'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nserver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("ä»¥ä¸Šå®ä¾‹æˆ‘æ”¾åœ¨è™šæ‹Ÿæœºé‡Œè¿›è¡Œæµ‹è¯•ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨æœ¬åœ°ç”µè„‘æµ‹è¯•ï¼Œä½¿ç”¨ AB æµ‹è¯•å·¥å…·ã€‚")]),t._v(" "),n("hr"),t._v(" "),n("p",[n("strong",[t._v("å‚è€ƒèµ„æ–™ï¼š")])]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://www.nodejs.red/#/nodejs/buffer",target:"_blank",rel:"noopener noreferrer"}},[t._v("ğŸ“ Node.js ä¸­çš„ç¼“å†²åŒºï¼ˆBufferï¼‰ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/24429470",target:"_blank",rel:"noopener noreferrer"}},[t._v("Node JS stream ä¸€ï¼šBuffer"),n("OutboundLink")],1)])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);